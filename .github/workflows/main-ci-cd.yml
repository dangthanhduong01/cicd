name: Luá»“ng CI/CD Xá»‹n XÃ²

on:
  push:
    branches: [ "main" ]

jobs:
  # GIAI ÄOáº N 1: CI (Kiá»ƒm tra)
  build-and-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: CÃ i Ä‘áº·t Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm install
      - run: npm test # Náº¿u lá»‡nh nÃ y lá»—i, quy trÃ¬nh dá»«ng ngay láº­p tá»©c!

  # GIAI ÄOáº N 2: CD (Triá»ƒn khai)
  deploy:
    runs-on: ubuntu-latest
    needs: build-and-test # QUAN TRá»ŒNG: Chá»‰ cháº¡y náº¿u build-and-test thÃ nh cÃ´ng
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Triá»ƒn khai lÃªn Vercel ğŸš€
        # Sá»­ dá»¥ng Action cÃ³ sáºµn cá»§a cá»™ng Ä‘á»“ng
        uses: amondnet/vercel-action@v20 
        with:
          vercel-token: ${{ secrets.NETLIFY_TOKEN }} # Láº¥y tá»« Secret Ä‘Ã£ cÃ i á»Ÿ BÆ°á»›c 1
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
          vercel-args: '--prod' # Äáº©y tháº³ng lÃªn mÃ´i trÆ°á»ng Production